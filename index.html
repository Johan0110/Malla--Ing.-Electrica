<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Malla Ingeniería Eléctrica UNAL</title>

<style>
body{
 margin:0;
 font-family:'Segoe UI',system-ui,sans-serif;
 background:#f4f6f9;
}

h1{text-align:center;margin:12px}

.top{
 display:flex;
 justify-content:space-between;
 align-items:center;
 padding:10px 20px;
 gap:15px;
}

.stats{font-size:13px;line-height:1.6}

button{
 padding:6px 14px;
 border:none;
 border-radius:8px;
 background:#e74c3c;
 color:white;
 cursor:pointer;
}

.legend{
 display:flex;
 gap:15px;
 font-size:13px;
}
.legend span{display:flex;align-items:center;gap:6px}
.box{width:14px;height:14px;border-radius:4px}

.fund-bg{background:#eadcf7}
.disc-bg{background:#d7f3ee}
.libre-bg{background:#fff0c9}

.progress-section{
 display:grid;
 grid-template-columns:repeat(4,1fr);
 gap:12px;
 padding:0 20px 15px;
}

.progress-card{
 background:white;
 border-radius:12px;
 padding:10px;
 font-size:12px;
 box-shadow:0 4px 10px rgba(0,0,0,.08);
}

.progress-bar{
 height:10px;
 background:#e0e0e0;
 border-radius:6px;
 overflow:hidden;
 margin-top:6px;
}

.progress-fill{
 height:100%;
 width:0%;
 transition:width .3s;
}

.fund-fill{background:#b18be8}
.disc-fill{background:#5fd1b2}
.libre-fill{background:#f3c94b}
.total-fill{background:#6aa9e9}

.container{
 display:grid;
 grid-template-columns:repeat(10,1fr);
 gap:12px;
 padding:15px;
}

.semester{
 background:white;
 border-radius:14px;
 padding:10px;
 box-shadow:0 4px 10px rgba(0,0,0,.08);
}

.semester h2{
 font-size:14px;
 text-align:center;
 margin:6px 0 10px;
}

.course{
 border-radius:10px;
 padding:8px;
 margin-bottom:8px;
 font-size:12px;
 cursor:pointer;
 transition:.2s;
}

.course:hover{transform:scale(1.03)}

.course.approved{
 text-decoration:line-through;
 font-weight:600;
}

.course.locked{
 opacity:.4;
 cursor:not-allowed;
}

.course.locked:hover::after{
 content:attr(data-tip);
 position:absolute;
 background:#333;
 color:#fff;
 font-size:11px;
 padding:5px 7px;
 border-radius:6px;
 white-space:nowrap;
 margin-top:4px;
}

/* COLORES DE LAS MATERIAS */
.course.fund{background:#eadcf7}
.course.disc{background:#d7f3ee}
.course.libre{background:#fff0c9}

.footer{
 text-align:center;
 font-size:12px;
 color:#777;
 margin-bottom:15px;
}
</style>
</head>

<body>

<h1>Malla Curricular – Ingeniería Eléctrica (UNAL)</h1>

<div class="top">
 <div class="stats" id="stats"></div>
 <button onclick="resetProgress()">Restablecer</button>
 <div class="legend">
  <span><div class="box fund-bg"></div>Fundamentación</span>
  <span><div class="box disc-bg"></div>Disciplinar</span>
  <span><div class="box libre-bg"></div>Libre</span>
 </div>
</div>

<div class="progress-section">
 <div class="progress-card">
  Fundamentación <b id="pf">0%</b>
  <div class="progress-bar"><div id="pfb" class="progress-fill fund-fill"></div></div>
 </div>
 <div class="progress-card">
  Disciplinar <b id="pd">0%</b>
  <div class="progress-bar"><div id="pdb" class="progress-fill disc-fill"></div></div>
 </div>
 <div class="progress-card">
  Libre Elección <b id="pl">0%</b>
  <div class="progress-bar"><div id="plb" class="progress-fill libre-fill"></div></div>
 </div>
 <div class="progress-card">
  Total <b id="pt">0%</b>
  <div class="progress-bar"><div id="ptb" class="progress-fill total-fill"></div></div>
 </div>
</div>

<div class="container" id="malla"></div>

<div class="footer">
 Clic para aprobar · Progreso automático · Guardado local
</div>

<script>
const data=[
 {sem:1,id:'CD',name:'Cálculo Diferencial',cred:4,comp:'fund'},
 {sem:1,id:'GV',name:'Geometría Vectorial',cred:4,comp:'fund'},
 {sem:1,id:'IE',name:'Introducción a Ing. Eléctrica',cred:2,comp:'disc'},
 {sem:1,id:'LE1',name:'Libre Elección',cred:3,comp:'libre'},

 {sem:2,id:'CI',name:'Cálculo Integral',cred:4,comp:'fund',req:['CD']},
 {sem:2,id:'AL',name:'Álgebra Lineal',cred:4,comp:'fund'},
 {sem:2,id:'FIS1',name:'Física Mecánica',cred:4,comp:'fund'},

 {sem:4,id:'LABC',name:'Laboratorio de Circuitos',cred:3,comp:'disc',fundPercent:40},
];

let approved=JSON.parse(localStorage.getItem('ie_aprobadas')||'[]');
const malla=document.getElementById('malla');
const stats=document.getElementById('stats');

function calc(comp){
 const total=data.filter(c=>c.comp===comp).reduce((s,c)=>s+c.cred,0);
 const done=data.filter(c=>c.comp===comp && approved.includes(c.id)).reduce((s,c)=>s+c.cred,0);
 return {done,total,p:total?Math.round(done/total*100):0};
}

function render(){
 malla.innerHTML='';
 const f=calc('fund'), d=calc('disc'), l=calc('libre');
 const totalDone=f.done+d.done+l.done;
 const totalAll=data.reduce((s,c)=>s+c.cred,0);
 const tp=Math.round(totalDone/totalAll*100);

 stats.innerHTML=`
 <b>Fundamentación:</b> ${f.done}/${f.total} (${f.p}%)<br>
 <b>Disciplinar:</b> ${d.done}/${d.total} (${d.p}%)<br>
 <b>Libre:</b> ${l.done}/${l.total} (${l.p}%)<br>
 <b>Total:</b> ${totalDone} créditos
 `;

 pf.textContent=f.p+'%'; pfb.style.width=f.p+'%';
 pd.textContent=d.p+'%'; pdb.style.width=d.p+'%';
 pl.textContent=l.p+'%'; plb.style.width=l.p+'%';
 pt.textContent=tp+'%'; ptb.style.width=tp+'%';

 for(let s=1;s<=10;s++){
  const col=document.createElement('div');
  col.className='semester';
  col.innerHTML=`<h2>Semestre ${s}</h2>`;

  data.filter(c=>c.sem===s).forEach(c=>{
   let locked=false,tip='';
   if(c.req && !c.req.every(r=>approved.includes(r))){
    locked=true; tip='Faltan prerrequisitos';
   }
   if(c.fundPercent && f.p<c.fundPercent){
    locked=true; tip=`Requiere ${c.fundPercent}% Fundamentación`;
   }

   const d=document.createElement('div');
   d.className=`course ${c.comp} ${approved.includes(c.id)?'approved':''} ${locked?'locked':''}`;
   d.innerHTML=`<b>${c.name}</b><br><small>${c.cred} créditos</small>`;
   if(locked) d.dataset.tip=tip;

   d.onclick=()=>{
    if(locked) return;
    approved.includes(c.id)
     ? approved=approved.filter(x=>x!==c.id)
     : approved.push(c.id);
    localStorage.setItem('ie_aprobadas',JSON.stringify(approved));
    render();
   };

   col.appendChild(d);
  });
  malla.appendChild(col);
 }
}

function resetProgress(){
 if(confirm('¿Restablecer todo el progreso?')){
  approved=[];
  localStorage.removeItem('ie_aprobadas');
  render();
 }
}

render();
</script>
</body>
</html>
