<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Malla Curricular – Ingeniería Eléctrica UNAL</title>
<style>
body{margin:0;font-family:'Segoe UI',system-ui,sans-serif;background:#f4f6f9;color:#2c3e50}
h1{text-align:center;margin:15px 0}

.top{
 display:flex;
 justify-content:space-between;
 align-items:center;
 padding:10px 20px;
 flex-wrap:wrap;
}

#contador{font-size:14px}

button{
 padding:6px 12px;
 border:none;
 border-radius:6px;
 cursor:pointer;
 background:#e74c3c;
 color:white;
}

.legend{
 display:flex;
 gap:15px;
 font-size:13px;
}
.legend span{
 display:flex;
 align-items:center;
 gap:6px;
}
.box{width:14px;height:14px;border-radius:4px}

.container{display:grid;grid-template-columns:repeat(10,1fr);gap:12px;padding:15px}
.semester{background:#fff;border-radius:14px;box-shadow:0 4px 10px rgba(0,0,0,.08);padding:10px}
.semester h2{text-align:center;font-size:14px;margin:6px 0 10px;color:#34495e}

.course{border-radius:10px;padding:8px;margin-bottom:8px;font-size:12px;cursor:pointer;transition:.2s;position:relative}
.course:hover{transform:scale(1.02)}
.course.approved{text-decoration:line-through;opacity:.85}
.course.locked{background:#f0f0f0!important;color:#aaa;cursor:not-allowed}
.course.locked:hover::after{
 content:attr(data-tip);
 position:absolute;
 left:0;
 top:105%;
 background:#333;
 color:#fff;
 font-size:11px;
 padding:5px 7px;
 border-radius:6px;
 white-space:nowrap;
 z-index:10
}

.fund{background:#e5d7f2}
.disc{background:#d2f0ea}
.libre{background:#ffe4a8}

.footer{text-align:center;font-size:12px;color:#777;margin:15px}
</style>
</head>

<body>

<h1>Malla Curricular Interactiva – Ingeniería Eléctrica (UNAL)</h1>

<div class="top">
  <div id="contador"></div>
  <button onclick="resetProgress()">Restablecer progreso</button>
  <div class="legend">
    <span><div class="box fund"></div>Fundamentación</span>
    <span><div class="box disc"></div>Formación Disciplinar</span>
    <span><div class="box libre"></div>Libre Elección</span>
  </div>
</div>

<div class="container" id="malla"></div>

<div class="footer">
 Clic para aprobar · Gris = bloqueada · El progreso se guarda automáticamente
</div>

<script>
const data=[
// sem, id, nombre, creditos, componente, requisitos
{sem:1,id:'1000004',name:'Cálculo Diferencial',cred:4,comp:'fund'},
{sem:1,id:'1000008',name:'Geometría Vectorial y Analítica',cred:4,comp:'fund'},
{sem:1,id:'3009531',name:'Introducción a la Ingeniería Eléctrica',cred:2,comp:'disc'},
{sem:1,id:'LE1',name:'Libre Elección',cred:3,comp:'libre'},
{sem:1,id:'LE2',name:'Libre Elección',cred:3,comp:'libre'},

{sem:2,id:'1000005',name:'Cálculo Integral',cred:4,comp:'fund',req:['1000004']},
{sem:2,id:'1000003',name:'Álgebra Lineal',cred:4,comp:'fund',req:['1000008']},
{sem:2,id:'1000019',name:'Física Mecánica',cred:4,comp:'fund',req:['1000004','1000008']},
{sem:2,id:'3010481',name:'Análisis de Circuitos Eléctricos I',cred:3,comp:'disc',req:['1000004']},
{sem:2,id:'LE3',name:'Libre Elección',cred:3,comp:'libre'},

{sem:3,id:'1000006',name:'Cálculo en Varias Variables',cred:4,comp:'fund',req:['1000005']},
{sem:3,id:'1000007',name:'Ecuaciones Diferenciales',cred:4,comp:'fund',req:['1000005','1000003']},
{sem:3,id:'1000017',name:'Física Electricidad y Magnetismo',cred:4,comp:'fund',req:['1000019','1000005']},
{sem:3,id:'3010435',name:'Fundamentos de Programación',cred:3,comp:'fund'},
{sem:3,id:'3010478',name:'Termodinámica General',cred:3,comp:'disc'},

{sem:4,id:'3010651',name:'Estadística I',cred:3,comp:'fund',req:['1000005']},
{sem:4,id:'3006905',name:'Matemáticas Especiales',cred:4,comp:'fund',req:['1000007']},
{sem:4,id:'3006907',name:'Métodos Numéricos',cred:4,comp:'fund',req:['1000005','1000003']},
{sem:4,id:'3010496',name:'Análisis de Circuitos Eléctricos II',cred:3,comp:'disc',req:['3010481','1000007']},
{sem:4,id:'3010408',name:'Fundamentos de Proyectos en Ingeniería',cred:3,comp:'disc',fundPercent:40},

{sem:5,id:'3010421',name:'Señales y Sistemas Lineales',cred:3,comp:'disc',req:['3006905']},
{sem:5,id:'3010520',name:'Teoría Electromagnética',cred:3,comp:'disc',req:['1000017']},
{sem:5,id:'3010458',name:'Electrónica Análoga I',cred:3,comp:'disc',req:['3010496']},
{sem:5,id:'LE4',name:'Libre Elección',cred:3,comp:'libre'}
];

let approved=JSON.parse(localStorage.getItem('ie_unal_aprobadas')||'[]');
const malla=document.getElementById('malla');
const contador=document.getElementById('contador');

function fundCreditsApproved(){
 return data.filter(c=>c.comp==='fund' && approved.includes(c.id))
            .reduce((a,b)=>a+b.cred,0);
}

function fundCreditsTotal(){
 return data.filter(c=>c.comp==='fund')
            .reduce((a,b)=>a+b.cred,0);
}

function render(){
 malla.innerHTML='';
 const total=approved.reduce((sum,id)=>{
  const c=data.find(x=>x.id===id);
  return c?sum+c.cred:sum;
 },0);
 contador.innerHTML=`<b>Créditos aprobados:</b> ${total}`;

 for(let s=1;s<=10;s++){
  const col=document.createElement('div');
  col.className='semester';
  col.innerHTML=`<h2>Semestre ${s}</h2>`;

  data.filter(c=>c.sem===s).forEach(c=>{
   let locked=false; let tip='';

   if(c.req && !c.req.every(r=>approved.includes(r))){
    locked=true; tip='Faltan prerrequisitos';
   }

   if(c.fundPercent){
    const percent=(fundCreditsApproved()/fundCreditsTotal())*100;
    if(percent < c.fundPercent){
     locked=true;
     tip=`Requiere ${c.fundPercent}% del componente de Fundamentación`;
    }
   }

   const d=document.createElement('div');
   d.className=`course ${c.comp} ${approved.includes(c.id)?'approved':''} ${locked?'locked':''}`;
   d.innerHTML=`<b>${c.name}</b><br><small>${c.cred} créditos</small>`;
   if(locked) d.dataset.tip=tip;

   d.onclick=()=>{
    if(locked) return;
    approved.includes(c.id)
      ? approved=approved.filter(x=>x!==c.id)
      : approved.push(c.id);
    localStorage.setItem('ie_unal_aprobadas',JSON.stringify(approved));
    render();
   };

   col.appendChild(d);
  });

  if(col.children.length>1) malla.appendChild(col);
 }
}

function resetProgress(){
 if(confirm('¿Deseas restablecer todo el progreso?')){
  approved=[];
  localStorage.removeItem('ie_unal_aprobadas');
  render();
 }
}

render();
</script>

</body>
</html>
